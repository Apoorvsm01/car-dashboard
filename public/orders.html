<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orders - Carvo Fleet Management</title>
    
    <!-- Component CSS Files -->
    <link rel="stylesheet" href="../assets/styles/layout.css">
    <link rel="stylesheet" href="../assets/styles/components/navbar.css">
    <link rel="stylesheet" href="../assets/styles/components/spotlight.css">
    
    <!-- External Libraries -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* Orders Page Specific Styles */
        .orders-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .orders-title h1 {
            font-size: 24px;
            font-weight: 600;
            color: #1F2937;
            margin: 0;
        }

        .orders-title p {
            color: #6B7280;
            margin-top: 4px;
        }

        .orders-actions {
            display: flex;
            gap: 12px;
        }

        .btn-add-order {
            background: #10B981;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease-in-out;
        }

        .btn-add-order:hover {
            background: #059669;
        }

        .orders-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid #E5E7EB;
        }

        .stat-card h3 {
            font-size: 14px;
            font-weight: 500;
            color: #6B7280;
            margin: 0 0 8px 0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-card .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 4px;
        }

        .stat-card .stat-change {
            font-size: 12px;
            color: #10B981;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .orders-filters {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid #E5E7EB;
        }

        .filters-row {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-group label {
            font-size: 14px;
            font-weight: 500;
            color: #374151;
        }

        .filter-group select,
        .filter-group input {
            padding: 8px 12px;
            border: 1px solid #D1D5DB;
            border-radius: 6px;
            font-size: 14px;
            min-width: 150px;
        }

        .orders-table {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid #E5E7EB;
        }

        .table-header {
            background: #F9FAFB;
            padding: 16px 20px;
            border-bottom: 1px solid #E5E7EB;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-header h3 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
            color: #1F2937;
        }

        .table-actions {
            display: flex;
            gap: 8px;
        }

        .table-content {
            overflow-x: auto;
        }

        .orders-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .orders-table th {
            background: #F9FAFB;
            padding: 12px 16px;
            text-align: left;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            border-bottom: 1px solid #E5E7EB;
        }

        .orders-table td {
            padding: 12px 16px;
            border-bottom: 1px solid #F3F4F6;
            font-size: 14px;
            color: #1F2937;
        }

        .orders-table tr:hover {
            background: #F9FAFB;
        }

        .order-id {
            font-weight: 600;
            color: #1F2937;
        }

        .vehicle-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .vehicle-image {
            width: 40px;
            height: 30px;
            border-radius: 4px;
            background: #F3F4F6;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9CA3AF;
            font-size: 12px;
        }

        .vehicle-details h4 {
            margin: 0 0 2px 0;
            font-size: 14px;
            font-weight: 600;
            color: #1F2937;
        }

        .vehicle-details p {
            margin: 0;
            font-size: 12px;
            color: #6B7280;
            font-family: 'Courier New', monospace;
        }

        .customer-info h4 {
            margin: 0 0 2px 0;
            font-size: 14px;
            font-weight: 600;
            color: #1F2937;
        }

        .customer-info p {
            margin: 0;
            font-size: 12px;
            color: #6B7280;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-badge.active {
            background: #D1FAE5;
            color: #065F46;
        }

        .status-badge.completed {
            background: #E0E7FF;
            color: #3730A3;
        }

        .status-badge.pending {
            background: #FEF3C7;
            color: #92400E;
        }

        .status-badge.cancelled {
            background: #FEE2E2;
            color: #991B1B;
        }

        .amount {
            font-weight: 600;
            color: #10B981;
        }

        .order-actions {
            display: flex;
            gap: 8px;
        }

        .btn-order-action {
            padding: 6px 12px;
            border: 1px solid #D1D5DB;
            border-radius: 4px;
            background: white;
            color: #6B7280;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }

        .btn-order-action:hover {
            background: #F3F4F6;
            color: #1F2937;
        }

        .btn-order-action.primary {
            background: #10B981;
            color: white;
            border-color: #10B981;
        }

        .btn-order-action.primary:hover {
            background: #059669;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 20px;
            border-top: 1px solid #E5E7EB;
        }

        .pagination button {
            padding: 8px 12px;
            border: 1px solid #D1D5DB;
            background: white;
            color: #6B7280;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }

        .pagination button:hover {
            background: #F3F4F6;
            color: #1F2937;
        }

        .pagination button.active {
            background: #10B981;
            color: white;
            border-color: #10B981;
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            .orders-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .orders-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .filters-row {
                flex-direction: column;
                align-items: stretch;
            }

            .orders-table {
                overflow-x: auto;
            }

            .order-actions {
                flex-direction: column;
                gap: 4px;
            }
        }
    </style>
</head>
<body>
    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-car sidebar-logo"></i>
                <span class="sidebar-title">Carvo</span>
            </div>
            <nav class="sidebar-nav">
                <a href="index.html" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </a>
                <a href="vehicles.html" class="nav-link">
                    <i class="fas fa-car"></i>
                    <span>Vehicles</span>
                    <i class="fas fa-chevron-down nav-arrow"></i>
                </a>
                <a href="customers.html" class="nav-link">
                    <i class="fas fa-users"></i>
                    <span>Customers</span>
                </a>
                <a href="orders.html" class="nav-link active">
                    <i class="fas fa-file-invoice-dollar"></i>
                    <span>Orders pricing</span>
                </a>
                <a href="reports.html" class="nav-link">
                    <i class="fas fa-chart-bar"></i>
                    <span>Reports</span>
                    <i class="fas fa-chevron-down nav-arrow"></i>
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="settings.html" class="nav-link">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
                <a href="help.html" class="nav-link">
                    <i class="fas fa-question-circle"></i>
                    <span>Help</span>
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <div class="orders-header">
                <div class="orders-title">
                    <h1>Orders</h1>
                    <p>Manage rental orders and pricing</p>
                </div>
                <div class="orders-actions">
                    <button class="btn-search" id="spotlight-trigger">
                        <i class="fas fa-search"></i>
                        Search
                    </button>
                    <button class="btn-add-order" onclick="addOrder()">
                        <i class="fas fa-plus"></i>
                        New Order
                    </button>
                </div>
            </div>

            <!-- Order Statistics -->
            <div class="orders-stats">
                <div class="stat-card">
                    <h3>Total Orders</h3>
                    <div class="stat-value">156</div>
                    <div class="stat-change">
                        <i class="fas fa-arrow-up"></i>
                        +12% from last month
                    </div>
                </div>
                <div class="stat-card">
                    <h3>Active Orders</h3>
                    <div class="stat-value">23</div>
                    <div class="stat-change">
                        <i class="fas fa-arrow-up"></i>
                        +5% from yesterday
                    </div>
                </div>
                <div class="stat-card">
                    <h3>Revenue</h3>
                    <div class="stat-value">$12,450</div>
                    <div class="stat-change">
                        <i class="fas fa-arrow-up"></i>
                        +8% from last week
                    </div>
                </div>
                <div class="stat-card">
                    <h3>Avg. Order Value</h3>
                    <div class="stat-value">$79.8</div>
                    <div class="stat-change">
                        <i class="fas fa-arrow-down"></i>
                        -2% from last month
                    </div>
                </div>
            </div>

            <!-- Filters -->
            <div class="orders-filters">
                <div class="filters-row">
                    <div class="filter-group">
                        <label>Status</label>
                        <select id="status-filter">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="completed">Completed</option>
                            <option value="pending">Pending</option>
                            <option value="cancelled">Cancelled</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Date Range</label>
                        <select id="date-filter">
                            <option value="">All Time</option>
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Customer</label>
                        <input type="text" id="customer-filter" placeholder="Search by customer...">
                    </div>
                    <div class="filter-group">
                        <label>Vehicle</label>
                        <input type="text" id="vehicle-filter" placeholder="Search by vehicle...">
                    </div>
                </div>
            </div>

            <!-- Orders Table -->
            <div class="orders-table">
                <div class="table-header">
                    <h3>Order List</h3>
                    <div class="table-actions">
                        <button class="btn-order-action" onclick="exportOrders()">
                            <i class="fas fa-download"></i> Export
                        </button>
                        <button class="btn-order-action" onclick="printOrders()">
                            <i class="fas fa-print"></i> Print
                        </button>
                    </div>
                </div>
                <div class="table-content">
                    <table>
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Vehicle</th>
                                <th>Customer</th>
                                <th>Start Date</th>
                                <th>End Date</th>
                                <th>Status</th>
                                <th>Amount</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="orders-tbody">
                            <!-- Order rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                <div class="pagination">
                    <button onclick="changePage(-1)" id="prev-btn">Previous</button>
                    <button class="active">1</button>
                    <button>2</button>
                    <button>3</button>
                    <button onclick="changePage(1)" id="next-btn">Next</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Add Order Popup -->
    <div id="add-order-popup" class="order-popup-overlay">
        <div class="order-popup">
            <div class="popup-header">
                <h3>Create New Order</h3>
                <button class="popup-close" id="add-order-popup-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="popup-content">
                <form id="add-order-form">
                    <div class="order-detail-section">
                        <h5 class="detail-section-title">Order Information</h5>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <label class="detail-label">Customer</label>
                                <select name="customerId" required class="detail-input">
                                    <option value="">Select Customer</option>
                                    <option value="1">Chris Evan</option>
                                    <option value="2">Chris Hemsworth</option>
                                    <option value="3">Wirman Mustafa</option>
                                    <option value="4">Bustomi Rizal Subaiki</option>
                                </select>
                            </div>
                            <div class="detail-item">
                                <label class="detail-label">Vehicle</label>
                                <select name="vehicleId" required class="detail-input">
                                    <option value="">Select Vehicle</option>
                                    <option value="1">Toyota Avalon V6 (B 3243 ABC)</option>
                                    <option value="2">Honda Civic 1.8 E C/T (B 1234 DEF)</option>
                                    <option value="3">Toyota Rav4 (B 5678 GHI)</option>
                                    <option value="4">Lexus ES 350 (B 9012 JKL)</option>
                                    <option value="5">Nissan X-Trail 2.5 CVT (B 3456 MNO)</option>
                                    <option value="6">Acura RDX (B 7890 PQR)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="order-detail-section">
                        <h5 class="detail-section-title">Rental Period</h5>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <label class="detail-label">Start Date</label>
                                <input type="date" name="startDate" required class="detail-input">
                            </div>
                            <div class="detail-item">
                                <label class="detail-label">End Date</label>
                                <input type="date" name="endDate" required class="detail-input">
                            </div>
                            <div class="detail-item">
                                <label class="detail-label">Daily Rate ($)</label>
                                <input type="number" name="dailyRate" min="0" step="0.01" required class="detail-input">
                            </div>
                        </div>
                    </div>
                    
                    <div class="popup-actions">
                        <button type="button" class="btn-secondary" onclick="closeAddOrderModal()">Cancel</button>
                        <button type="submit" class="btn-primary">Create Order</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Orders Page Script -->
    <script src="../assets/scripts/config/api-config.js"></script>
    <script src="../assets/scripts/services/PixabayService.js"></script>
    <script>
        // Orders data
        const orders = [
            {
                id: '23827322',
                customerId: 1,
                vehicleId: 1,
                customer: 'Chris Evan',
                vehicle: {
                    model: 'Toyota Avalon V6',
                    licensePlate: 'B 3243 ABC',
                    image: 'https://images.unsplash.com/photo-1549317661-bd32c8ce0db2?w=400&h=300&fit=crop'
                },
                startDate: '2024-06-20',
                endDate: '2024-06-24',
                status: 'active',
                amount: 450,
                dailyRate: 65
            },
            {
                id: '23827323',
                customerId: 2,
                vehicleId: 2,
                customer: 'Sarah Johnson',
                vehicle: {
                    model: 'Honda Civic 1.8 E C/T',
                    licensePlate: 'B 1234 DEF',
                    image: 'https://images.unsplash.com/photo-1552519507-da3b142c6e3d?w=400&h=300&fit=crop'
                },
                startDate: '2024-06-22',
                endDate: '2024-06-25',
                status: 'active',
                amount: 520,
                dailyRate: 55
            },
            {
                id: '23827324',
                customerId: 3,
                vehicleId: 3,
                customer: 'Michael Chen',
                vehicle: {
                    model: 'Toyota Rav4',
                    licensePlate: 'B 5678 GHI',
                    image: 'https://images.unsplash.com/photo-1555215695-3004980ad54e?w=400&h=300&fit=crop'
                },
                startDate: '2024-06-23',
                endDate: '2024-06-26',
                status: 'completed',
                amount: 580,
                dailyRate: 60
            },
            {
                id: '23827325',
                customerId: 4,
                vehicleId: 4,
                customer: 'Emily Davis',
                vehicle: {
                    model: 'Lexus ES 350',
                    licensePlate: 'B 9012 JKL',
                    image: 'https://images.unsplash.com/photo-1606664515524-ed2f786a0bd6?w=400&h=300&fit=crop'
                },
                startDate: '2024-07-01',
                endDate: '2024-07-05',
                status: 'pending',
                amount: 650,
                dailyRate: 75
            },
            {
                id: '23827326',
                customerId: 5,
                vehicleId: 5,
                customer: 'David Wilson',
                vehicle: {
                    model: 'Nissan X-Trail 2.5 CVT',
                    licensePlate: 'B 3456 MNO',
                    image: 'https://images.unsplash.com/photo-1582639510494-c80b5de9f148?w=400&h=300&fit=crop'
                },
                startDate: '2024-06-24',
                endDate: '2024-06-29',
                status: 'active',
                amount: 720,
                dailyRate: 70
            },
            {
                id: '23827327',
                customerId: 6,
                vehicleId: 6,
                customer: 'Lisa Anderson',
                vehicle: {
                    model: 'Acura RDX',
                    licensePlate: 'B 7890 PQR',
                    image: 'https://images.unsplash.com/photo-1617814076367-b759c7d7e738?w=400&h=300&fit=crop'
                },
                startDate: '2024-06-25',
                endDate: '2024-06-30',
                status: 'active',
                amount: 800,
                dailyRate: 80
            }
        ];

        let currentPage = 1;
        const itemsPerPage = 10;

        // Initialize orders page
        function initOrdersPage() {
            renderOrders(orders);
            setupFilters();
            setupModalHandlers();
            updateStats();
        }

        // Render orders table
        function renderOrders(ordersToRender) {
            const tbody = document.getElementById('orders-tbody');
            tbody.innerHTML = '';

            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedOrders = ordersToRender.slice(startIndex, endIndex);

            paginatedOrders.forEach(order => {
                const row = createOrderRow(order);
                tbody.appendChild(row);
            });

            updatePagination(ordersToRender.length);
        }

        // Create order table row
        function createOrderRow(order) {
            const row = document.createElement('tr');
            
            row.innerHTML = `
                <td>
                    <span class="order-id">#${order.id}</span>
                </td>
                <td>
                    <div class="vehicle-info">
                        <div class="vehicle-image">
                            <i class="fas fa-car"></i>
                        </div>
                        <div class="vehicle-details">
                            <h4>${order.vehicle.model}</h4>
                            <p>${order.vehicle.licensePlate}</p>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="customer-info">
                        <h4>${order.customer}</h4>
                        <p>Customer ID: ${order.customerId}</p>
                    </div>
                </td>
                <td>${new Date(order.startDate).toLocaleDateString()}</td>
                <td>${new Date(order.endDate).toLocaleDateString()}</td>
                <td>
                    <span class="status-badge ${order.status}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span>
                </td>
                <td>
                    <span class="amount">$${order.amount.toLocaleString()}</span>
                </td>
                <td>
                    <div class="order-actions">
                        <button class="btn-order-action" onclick="viewOrder('${order.id}')">
                            <i class="fas fa-eye"></i> View
                        </button>
                        <button class="btn-order-action" onclick="editOrder('${order.id}')">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn-order-action primary" onclick="updateOrderStatus('${order.id}')">
                            <i class="fas fa-check"></i> Update
                        </button>
                    </div>
                </td>
            `;

            return row;
        }

        // Update pagination
        function updatePagination(totalItems) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            const pagination = document.querySelector('.pagination');
            
            // Update page buttons
            const pageButtons = pagination.querySelectorAll('button:not(#prev-btn):not(#next-btn)');
            pageButtons.forEach((btn, index) => {
                if (index < totalPages) {
                    btn.style.display = 'inline-block';
                    btn.textContent = index + 1;
                    btn.classList.toggle('active', index + 1 === currentPage);
                } else {
                    btn.style.display = 'none';
                }
            });

            // Update prev/next buttons
            document.getElementById('prev-btn').disabled = currentPage === 1;
            document.getElementById('next-btn').disabled = currentPage === totalPages;
        }

        // Change page
        function changePage(direction) {
            const totalPages = Math.ceil(orders.length / itemsPerPage);
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                renderOrders(orders);
            }
        }

        // Update statistics
        function updateStats() {
            const totalOrders = orders.length;
            const activeOrders = orders.filter(o => o.status === 'active').length;
            const totalRevenue = orders.reduce((sum, o) => sum + o.amount, 0);
            const avgOrderValue = totalRevenue / totalOrders;

            // Update stat cards
            document.querySelector('.orders-stats .stat-card:nth-child(1) .stat-value').textContent = totalOrders;
            document.querySelector('.orders-stats .stat-card:nth-child(2) .stat-value').textContent = activeOrders;
            document.querySelector('.orders-stats .stat-card:nth-child(3) .stat-value').textContent = `$${totalRevenue.toLocaleString()}`;
            document.querySelector('.orders-stats .stat-card:nth-child(4) .stat-value').textContent = `$${avgOrderValue.toFixed(1)}`;
        }

        // Setup filters
        function setupFilters() {
            const statusFilter = document.getElementById('status-filter');
            const dateFilter = document.getElementById('date-filter');
            const customerFilter = document.getElementById('customer-filter');
            const vehicleFilter = document.getElementById('vehicle-filter');

            [statusFilter, dateFilter, customerFilter, vehicleFilter].forEach(filter => {
                filter.addEventListener('change', filterOrders);
                filter.addEventListener('input', filterOrders);
            });
        }

        // Filter orders
        function filterOrders() {
            const statusFilter = document.getElementById('status-filter').value;
            const dateFilter = document.getElementById('date-filter').value;
            const customerFilter = document.getElementById('customer-filter').value.toLowerCase();
            const vehicleFilter = document.getElementById('vehicle-filter').value.toLowerCase();

            const filteredOrders = orders.filter(order => {
                const matchesStatus = !statusFilter || order.status === statusFilter;
                const matchesCustomer = !customerFilter || order.customer.toLowerCase().includes(customerFilter);
                const matchesVehicle = !vehicleFilter || 
                    order.vehicle.model.toLowerCase().includes(vehicleFilter) ||
                    order.vehicle.licensePlate.toLowerCase().includes(vehicleFilter);

                let matchesDate = true;
                if (dateFilter) {
                    const orderDate = new Date(order.startDate);
                    const today = new Date();
                    
                    switch (dateFilter) {
                        case 'today':
                            matchesDate = orderDate.toDateString() === today.toDateString();
                            break;
                        case 'week':
                            const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
                            matchesDate = orderDate >= weekAgo;
                            break;
                        case 'month':
                            const monthAgo = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());
                            matchesDate = orderDate >= monthAgo;
                            break;
                    }
                }

                return matchesStatus && matchesDate && matchesCustomer && matchesVehicle;
            });

            currentPage = 1; // Reset to first page when filtering
            renderOrders(filteredOrders);
        }

        // Setup popup handlers
        function setupModalHandlers() {
            const popup = document.getElementById('add-order-popup');
            const closeBtn = document.getElementById('add-order-popup-close');
            const form = document.getElementById('add-order-form');

            closeBtn.addEventListener('click', closeAddOrderModal);
            popup.addEventListener('click', (e) => {
                if (e.target === popup) closeAddOrderModal();
            });

            form.addEventListener('submit', handleAddOrder);
        }

        // Add order popup functions
        function addOrder() {
            document.getElementById('add-order-popup').classList.add('active');
        }

        function closeAddOrderModal() {
            document.getElementById('add-order-popup').classList.remove('active');
            document.getElementById('add-order-form').reset();
        }

        function handleAddOrder(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            // Calculate amount based on dates and daily rate
            const startDate = new Date(formData.get('startDate'));
            const endDate = new Date(formData.get('endDate'));
            const dailyRate = parseFloat(formData.get('dailyRate'));
            const days = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24));
            const amount = days * dailyRate;

            const newOrder = {
                id: `238273${String(orders.length + 26).padStart(2, '0')}`,
                customerId: parseInt(formData.get('customerId')),
                vehicleId: parseInt(formData.get('vehicleId')),
                customer: getCustomerName(formData.get('customerId')),
                vehicle: getVehicleInfo(formData.get('vehicleId')),
                startDate: formData.get('startDate'),
                endDate: formData.get('endDate'),
                status: 'pending',
                amount: amount,
                dailyRate: dailyRate
            };

            orders.push(newOrder);
            renderOrders(orders);
            updateStats();
            closeAddOrderModal();
        }

        // Helper functions
        function getCustomerName(customerId) {
            const customers = {
                1: 'Chris Evan',
                2: 'Chris Hemsworth',
                3: 'Wirman Mustafa',
                4: 'Bustomi Rizal Subaiki'
            };
            return customers[customerId] || 'Unknown Customer';
        }

        function getVehicleInfo(vehicleId) {
            const vehicles = {
                1: { model: 'Toyota Avalon V6', licensePlate: 'B 3243 ABC' },
                2: { model: 'Honda Civic 1.8 E C/T', licensePlate: 'B 1234 DEF' },
                3: { model: 'Toyota Rav4', licensePlate: 'B 5678 GHI' },
                4: { model: 'Lexus ES 350', licensePlate: 'B 9012 JKL' },
                5: { model: 'Nissan X-Trail 2.5 CVT', licensePlate: 'B 3456 MNO' },
                6: { model: 'Acura RDX', licensePlate: 'B 7890 PQR' }
            };
            return vehicles[vehicleId] || { model: 'Unknown Vehicle', licensePlate: 'N/A' };
        }

        // Order action functions
        function viewOrder(id) {
            const order = orders.find(o => o.id === id);
            if (order) {
                alert(`Viewing order: ${order.id}`);
            }
        }

        function editOrder(id) {
            const order = orders.find(o => o.id === id);
            if (order) {
                alert(`Editing order: ${order.id}`);
            }
        }

        function updateOrderStatus(id) {
            const order = orders.find(o => o.id === id);
            if (order) {
                const newStatus = prompt(`Update status for order ${id} (active/completed/pending/cancelled):`, order.status);
                if (newStatus && ['active', 'completed', 'pending', 'cancelled'].includes(newStatus)) {
                    order.status = newStatus;
                    renderOrders(orders);
                    updateStats();
                }
            }
        }

        // Export and print functions
        function exportOrders() {
            alert('Exporting orders to CSV...');
        }

        function printOrders() {
            window.print();
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', initOrdersPage);
    </script>

    <!-- Spotlight Search Overlay -->
    <div id="spotlight-overlay" class="spotlight-overlay">
        <div class="spotlight-container">
            <div class="spotlight-search">
                <div class="search-icon">
                    <i class="fas fa-search"></i>
                </div>
                <input type="text" id="spotlight-input" placeholder="Search orders, vehicles, customers..." autocomplete="off">
                <div class="search-actions">
                    <button class="search-close" id="spotlight-close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="spotlight-results" id="spotlight-results">
                <!-- Results will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Order Details Popup -->
    <div id="order-popup" class="order-popup-overlay">
        <div class="order-popup">
            <div class="popup-header">
                <h3>Order Details</h3>
                <button class="popup-close" id="order-popup-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="popup-content" id="order-popup-content">
                <!-- Order details will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Spotlight Component Script -->
    <script src="../assets/scripts/components/SpotlightComponent.js"></script>
    <script>
        // Initialize Spotlight Component for orders page
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof SpotlightComponent !== 'undefined') {
                new SpotlightComponent();
                console.log('✅ Spotlight component initialized for orders page');
            }
        });
    </script>
</body>
</html>
