<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customers - Carvo Fleet Management</title>
    
    <!-- Component CSS Files -->
    <link rel="stylesheet" href="../assets/styles/layout.css">
    <link rel="stylesheet" href="../assets/styles/components/navbar.css">
    <link rel="stylesheet" href="../assets/styles/components/spotlight.css">
    
    <!-- External Libraries -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* Customers Page Specific Styles */
        .customers-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .customers-title h1 {
            font-size: 24px;
            font-weight: 600;
            color: #1F2937;
            margin: 0;
        }

        .customers-title p {
            color: #6B7280;
            margin-top: 4px;
        }

        .customers-actions {
            display: flex;
            gap: 12px;
        }

        .btn-add-customer {
            background: #10B981;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease-in-out;
        }

        .btn-add-customer:hover {
            background: #059669;
        }

        .customers-filters {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid #E5E7EB;
        }

        .filters-row {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-group label {
            font-size: 14px;
            font-weight: 500;
            color: #374151;
        }

        .filter-group select,
        .filter-group input {
            padding: 8px 12px;
            border: 1px solid #D1D5DB;
            border-radius: 6px;
            font-size: 14px;
            min-width: 150px;
        }

        .customers-table {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid #E5E7EB;
        }

        .table-header {
            background: #F9FAFB;
            padding: 16px 20px;
            border-bottom: 1px solid #E5E7EB;
        }

        .table-header h3 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
            color: #1F2937;
        }

        .table-content {
            overflow-x: auto;
        }

        .customers-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .customers-table th {
            background: #F9FAFB;
            padding: 12px 16px;
            text-align: left;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            border-bottom: 1px solid #E5E7EB;
        }

        .customers-table td {
            padding: 12px 16px;
            border-bottom: 1px solid #F3F4F6;
            font-size: 14px;
            color: #1F2937;
        }

        .customers-table tr:hover {
            background: #F9FAFB;
        }

        .customer-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #10B981;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
        }

        .customer-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .customer-details h4 {
            margin: 0 0 4px 0;
            font-size: 14px;
            font-weight: 600;
            color: #1F2937;
        }

        .customer-details p {
            margin: 0;
            font-size: 12px;
            color: #6B7280;
        }

        .membership-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .membership-badge.premium {
            background: #FEF3C7;
            color: #92400E;
        }

        .membership-badge.standard {
            background: #E0E7FF;
            color: #3730A3;
        }

        .membership-badge.basic {
            background: #E5E7EB;
            color: #374151;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-badge.active {
            background: #D1FAE5;
            color: #065F46;
        }

        .status-badge.inactive {
            background: #FEE2E2;
            color: #991B1B;
        }

        .customer-actions {
            display: flex;
            gap: 8px;
        }

        .btn-customer-action {
            padding: 6px 12px;
            border: 1px solid #D1D5DB;
            border-radius: 4px;
            background: white;
            color: #6B7280;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }

        .btn-customer-action:hover {
            background: #F3F4F6;
            color: #1F2937;
        }

        .btn-customer-action.primary {
            background: #10B981;
            color: white;
            border-color: #10B981;
        }

        .btn-customer-action.primary:hover {
            background: #059669;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 20px;
            border-top: 1px solid #E5E7EB;
        }

        .pagination button {
            padding: 8px 12px;
            border: 1px solid #D1D5DB;
            background: white;
            color: #6B7280;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }

        .pagination button:hover {
            background: #F3F4F6;
            color: #1F2937;
        }

        .pagination button.active {
            background: #10B981;
            color: white;
            border-color: #10B981;
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            .customers-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .filters-row {
                flex-direction: column;
                align-items: stretch;
            }

            .customers-table {
                overflow-x: auto;
            }

            .customer-actions {
                flex-direction: column;
                gap: 4px;
            }
        }
    </style>
</head>
<body>
    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-car sidebar-logo"></i>
                <span class="sidebar-title">Carvo</span>
            </div>
            <nav class="sidebar-nav">
                <a href="index.html" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </a>
                <a href="vehicles.html" class="nav-link">
                    <i class="fas fa-car"></i>
                    <span>Vehicles</span>
                    <i class="fas fa-chevron-down nav-arrow"></i>
                </a>
                <a href="customers.html" class="nav-link active">
                    <i class="fas fa-users"></i>
                    <span>Customers</span>
                </a>
                <a href="orders.html" class="nav-link">
                    <i class="fas fa-file-invoice-dollar"></i>
                    <span>Orders pricing</span>
                </a>
                <a href="reports.html" class="nav-link">
                    <i class="fas fa-chart-bar"></i>
                    <span>Reports</span>
                    <i class="fas fa-chevron-down nav-arrow"></i>
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="settings.html" class="nav-link">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
                <a href="help.html" class="nav-link">
                    <i class="fas fa-question-circle"></i>
                    <span>Help</span>
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <div class="customers-header">
                <div class="customers-title">
                    <h1>Customers</h1>
                    <p>Manage your customer database</p>
                </div>
                <div class="customers-actions">
                    <button class="btn-search" id="spotlight-trigger">
                        <i class="fas fa-search"></i>
                        Search
                    </button>
                    <button class="btn-add-customer" onclick="addCustomer()">
                        <i class="fas fa-plus"></i>
                        Add Customer
                    </button>
                </div>
            </div>

            <!-- Filters -->
            <div class="customers-filters">
                <div class="filters-row">
                    <div class="filter-group">
                        <label>Membership</label>
                        <select id="membership-filter">
                            <option value="">All Memberships</option>
                            <option value="premium">Premium</option>
                            <option value="standard">Standard</option>
                            <option value="basic">Basic</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Status</label>
                        <select id="status-filter">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Search</label>
                        <input type="text" id="search-filter" placeholder="Search customers...">
                    </div>
                </div>
            </div>

            <!-- Customers Table -->
            <div class="customers-table">
                <div class="table-header">
                    <h3>Customer List</h3>
                </div>
                <div class="table-content">
                    <table>
                        <thead>
                            <tr>
                                <th>Customer</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Membership</th>
                                <th>Status</th>
                                <th>Join Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="customers-tbody">
                            <!-- Customer rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                <div class="pagination">
                    <button onclick="changePage(-1)" id="prev-btn">Previous</button>
                    <button class="active">1</button>
                    <button>2</button>
                    <button>3</button>
                    <button onclick="changePage(1)" id="next-btn">Next</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Add Customer Popup -->
    <div id="add-customer-popup" class="order-popup-overlay">
        <div class="order-popup">
            <div class="popup-header">
                <h3>Add New Customer</h3>
                <button class="popup-close" id="add-customer-popup-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="popup-content">
                <form id="add-customer-form">
                    <div class="order-detail-section">
                        <h5 class="detail-section-title">Personal Information</h5>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <label class="detail-label">Full Name</label>
                                <input type="text" name="name" required class="detail-input">
                            </div>
                            <div class="detail-item">
                                <label class="detail-label">Email</label>
                                <input type="email" name="email" required class="detail-input">
                            </div>
                            <div class="detail-item">
                                <label class="detail-label">Phone</label>
                                <input type="tel" name="phone" required class="detail-input">
                            </div>
                            <div class="detail-item">
                                <label class="detail-label">Membership</label>
                                <select name="membership" required class="detail-input">
                                    <option value="basic">Basic</option>
                                    <option value="standard">Standard</option>
                                    <option value="premium">Premium</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="order-detail-section">
                        <h5 class="detail-section-title">Address Information</h5>
                        <div class="detail-item">
                            <label class="detail-label">Address</label>
                            <textarea name="address" rows="3" class="detail-input"></textarea>
                        </div>
                    </div>
                    
                    <div class="popup-actions">
                        <button type="button" class="btn-secondary" onclick="closeAddCustomerModal()">Cancel</button>
                        <button type="submit" class="btn-primary">Add Customer</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Customers Page Script -->
    <script src="../assets/scripts/config/api-config.js"></script>
    <script src="../assets/scripts/services/PixabayService.js"></script>
    <script>
        // Customers data
        const customers = [
            {
                id: 1,
                name: 'Chris Evan',
                email: 'chris.evan@email.com',
                phone: '081273832821',
                address: '123 Main St, New York, NY',
                membership: 'premium',
                status: 'active',
                joinDate: '2023-01-15'
            },
            {
                id: 2,
                name: 'Chris Hemsworth',
                email: 'chris.hemsworth@email.com',
                phone: '081234567890',
                address: '456 Oak Ave, Los Angeles, CA',
                membership: 'standard',
                status: 'active',
                joinDate: '2023-03-22'
            },
            {
                id: 3,
                name: 'Wirman Mustafa',
                email: 'wirman.mustafa@email.com',
                phone: '081345678901',
                address: '789 Pine Rd, Chicago, IL',
                membership: 'basic',
                status: 'active',
                joinDate: '2023-05-10'
            },
            {
                id: 4,
                name: 'Bustomi Rizal Subaiki',
                email: 'bustomi.rizal@email.com',
                phone: '081456789012',
                address: '321 Elm St, Houston, TX',
                membership: 'premium',
                status: 'inactive',
                joinDate: '2023-02-08'
            }
        ];

        let currentPage = 1;
        const itemsPerPage = 10;

        // Initialize customers page
        function initCustomersPage() {
            renderCustomers(customers);
            setupFilters();
            setupModalHandlers();
        }

        // Render customers table
        function renderCustomers(customersToRender) {
            const tbody = document.getElementById('customers-tbody');
            tbody.innerHTML = '';

            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedCustomers = customersToRender.slice(startIndex, endIndex);

            paginatedCustomers.forEach(customer => {
                const row = createCustomerRow(customer);
                tbody.appendChild(row);
            });

            updatePagination(customersToRender.length);
        }

        // Create customer table row
        function createCustomerRow(customer) {
            const row = document.createElement('tr');
            
            const initials = customer.name.split(' ').map(n => n[0]).join('').toUpperCase();
            
            row.innerHTML = `
                <td>
                    <div class="customer-info">
                        <div class="customer-avatar">${initials}</div>
                        <div class="customer-details">
                            <h4>${customer.name}</h4>
                            <p>ID: ${customer.id}</p>
                        </div>
                    </div>
                </td>
                <td>${customer.email}</td>
                <td>${customer.phone}</td>
                <td>
                    <span class="membership-badge ${customer.membership}">${customer.membership.charAt(0).toUpperCase() + customer.membership.slice(1)}</span>
                </td>
                <td>
                    <span class="status-badge ${customer.status}">${customer.status.charAt(0).toUpperCase() + customer.status.slice(1)}</span>
                </td>
                <td>${new Date(customer.joinDate).toLocaleDateString()}</td>
                <td>
                    <div class="customer-actions">
                        <button class="btn-customer-action" onclick="viewCustomer(${customer.id})">
                            <i class="fas fa-eye"></i> View
                        </button>
                        <button class="btn-customer-action" onclick="editCustomer(${customer.id})">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn-customer-action primary" onclick="contactCustomer(${customer.id})">
                            <i class="fas fa-phone"></i> Contact
                        </button>
                    </div>
                </td>
            `;

            return row;
        }

        // Update pagination
        function updatePagination(totalItems) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            const pagination = document.querySelector('.pagination');
            
            // Update page buttons
            const pageButtons = pagination.querySelectorAll('button:not(#prev-btn):not(#next-btn)');
            pageButtons.forEach((btn, index) => {
                if (index < totalPages) {
                    btn.style.display = 'inline-block';
                    btn.textContent = index + 1;
                    btn.classList.toggle('active', index + 1 === currentPage);
                } else {
                    btn.style.display = 'none';
                }
            });

            // Update prev/next buttons
            document.getElementById('prev-btn').disabled = currentPage === 1;
            document.getElementById('next-btn').disabled = currentPage === totalPages;
        }

        // Change page
        function changePage(direction) {
            const totalPages = Math.ceil(customers.length / itemsPerPage);
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                renderCustomers(customers);
            }
        }

        // Setup filters
        function setupFilters() {
            const membershipFilter = document.getElementById('membership-filter');
            const statusFilter = document.getElementById('status-filter');
            const searchFilter = document.getElementById('search-filter');

            [membershipFilter, statusFilter, searchFilter].forEach(filter => {
                filter.addEventListener('change', filterCustomers);
                filter.addEventListener('input', filterCustomers);
            });
        }

        // Filter customers
        function filterCustomers() {
            const membershipFilter = document.getElementById('membership-filter').value;
            const statusFilter = document.getElementById('status-filter').value;
            const searchFilter = document.getElementById('search-filter').value.toLowerCase();

            const filteredCustomers = customers.filter(customer => {
                const matchesMembership = !membershipFilter || customer.membership === membershipFilter;
                const matchesStatus = !statusFilter || customer.status === statusFilter;
                const matchesSearch = !searchFilter || 
                    customer.name.toLowerCase().includes(searchFilter) ||
                    customer.email.toLowerCase().includes(searchFilter) ||
                    customer.phone.includes(searchFilter);

                return matchesMembership && matchesStatus && matchesSearch;
            });

            currentPage = 1; // Reset to first page when filtering
            renderCustomers(filteredCustomers);
        }

        // Setup popup handlers
        function setupModalHandlers() {
            const popup = document.getElementById('add-customer-popup');
            const closeBtn = document.getElementById('add-customer-popup-close');
            const form = document.getElementById('add-customer-form');

            closeBtn.addEventListener('click', closeAddCustomerModal);
            popup.addEventListener('click', (e) => {
                if (e.target === popup) closeAddCustomerModal();
            });

            form.addEventListener('submit', handleAddCustomer);
        }

        // Add customer popup functions
        function addCustomer() {
            document.getElementById('add-customer-popup').classList.add('active');
        }

        function closeAddCustomerModal() {
            document.getElementById('add-customer-popup').classList.remove('active');
            document.getElementById('add-customer-form').reset();
        }

        function handleAddCustomer(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const newCustomer = {
                id: customers.length + 1,
                name: formData.get('name'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                address: formData.get('address'),
                membership: formData.get('membership'),
                status: 'active',
                joinDate: new Date().toISOString().split('T')[0]
            };

            customers.push(newCustomer);
            renderCustomers(customers);
            closeAddCustomerModal();
        }

        // Customer action functions
        function viewCustomer(id) {
            const customer = customers.find(c => c.id === id);
            if (customer) {
                alert(`Viewing customer: ${customer.name}`);
            }
        }

        function editCustomer(id) {
            const customer = customers.find(c => c.id === id);
            if (customer) {
                alert(`Editing customer: ${customer.name}`);
            }
        }

        function contactCustomer(id) {
            const customer = customers.find(c => c.id === id);
            if (customer) {
                alert(`Contacting customer: ${customer.name} at ${customer.phone}`);
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', initCustomersPage);
    </script>

    <!-- Spotlight Search Overlay -->
    <div id="spotlight-overlay" class="spotlight-overlay">
        <div class="spotlight-container">
            <div class="spotlight-search">
                <div class="search-icon">
                    <i class="fas fa-search"></i>
                </div>
                <input type="text" id="spotlight-input" placeholder="Search customers, vehicles, orders..." autocomplete="off">
                <div class="search-actions">
                    <button class="search-close" id="spotlight-close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="spotlight-results" id="spotlight-results">
                <!-- Results will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Customer Details Popup -->
    <div id="customer-popup" class="order-popup-overlay">
        <div class="order-popup">
            <div class="popup-header">
                <h3>Customer Details</h3>
                <button class="popup-close" id="customer-popup-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="popup-content" id="customer-popup-content">
                <!-- Customer details will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Spotlight Component Script -->
    <script src="../assets/scripts/components/SpotlightComponent.js"></script>
    <script>
        // Initialize Spotlight Component for customers page
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof SpotlightComponent !== 'undefined') {
                new SpotlightComponent();
                console.log('✅ Spotlight component initialized for customers page');
            }
        });
    </script>
</body>
</html>
